{%  extends 'layout.html' %}

{%  block body %}

    <body onload="document.body.style.opacity='1'">
    <link href="/static/aster-demo.css" rel="stylesheet">

    <main role="main" class="row home-bg-1" id='demo'>
        <title>Aster | Demo</title>

        <div class="tagline tagline-offset tagline-demo">
            An interactive dashboard for first responders.
        </div>
        <div class="container row">
            <div class="demo-feature col-3 align-top row" style="padding-right: 10px">
                <text>
                    This is a simplified version of the dashboard that will be presented to call centers.
                    <br>
                    <br>
                    An interactive map displays the most recent calls. The priority scores and classes are displayed
                    on the right. This helps operators focus their efforts on those calls which require immediate
                    attention.
                </text>
                <div class="btn-holder text-center row" style="width: 80%">

                    <!-- Button trigger modal -->
                    <button type="button" class="btn aster-btn btn-outline-success btn-block mt-auto activated"
                            data-loading-text="Try me!" data-toggle="modal" data-target="#startDemo">Try me!</button>

                    <!-- Modal Phone Number-->
                    <div class="modal fade" id="startDemo" tabindex="-1" role="dialog"
                         aria-labelledby="startDemo" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content aster-theme-modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="startDemoLabel">Try me!</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form>
                                        <div class="form-group">
                                            <label for="phone-number" class="col-form-label" align="left">
                                                Welcome to the demo of AsTeR's v1.0!<br><br>
                                                Enter your phone number and call (208) 953-2494 as if you
                                                were calling 911.<br><br>
                                                Briefly summarize your emergency and don't forget to
                                                mention your location!
                                            </label><br>
                                            <input class="form-control form-control-sm" name = "phone number"
                                                   type="text" placeholder="Enter your phone number here"
                                                   id="phone-number-input">
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn aster-btn btn-outline-success btn-block mt-auto activated"
                                            id = "start-demo" data-toggle="modal" data-target="#asterDemo"
                                            data-dismiss="modal">Ready!</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Demo-->
                    <div class="modal fade" id="asterDemo" tabindex="-1" role="dialog"
                         aria-labelledby="asterDemo" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content aster-theme-modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="asterDemoLabel">Demo</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form>
                                        <div class="form-group">
                                            <label for="phone-number" class="col-form-label" align="left">
                                                Populate this with the output of the endpoint:
                                                text,
                                                location,
                                                score,
                                                class
                                            </label>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn aster-btn btn-outline-success btn-block mt-auto activated"
                                            data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col demo-feature-with-border">
                <div id= 'map'></div>
                <script type="text/javascript">
                    var map_parameters = {{ map_parameters|tojson|safe }};
                </script>
                <script type="text/javascript" src="/static/includes/aster-map.js"></script>
                <script async defer src="https://maps.googleapis.com/maps/api/js?key={{google_key}}&callback=initMap&language=en"></script>
                {#                <div id="legend"><h5>Legend</h5></div>#}
            </div>
            <div class="demo-feature col-3">
                <h1 class="text-center calls">Incoming calls</h1>
            </div>
        </div>
    </main>
    </body>

 <script>

        var $message = document.getElementById('display-message');
        var $location = document.getElementById('display-location');
        var $score = document.getElementById('display-score');
        var $class = document.getElementById('display-class');

        document.getElementById('start-demo').addEventListener('click', function(event){

            var phone_number = document.getElementById("phone-number-input").value;

            $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
            $.getJSON($SCRIPT_ROOT+"/nlp_analysis?phone_number="+phone_number, function(response) {
                $message.innerHTML = response.message;
                $location.innerHTML = response.location;
                $score.innerHTML = response.score;
                $class.innerHTML = response.class;
            });

        }, false);

    </script>

{% endblock %}